function module(t,e,s){var i,o,a,n;s.exportDefault=function(t){i=t},s.link("moment",{default:function(t){a=t}},0),s.link("../components/PrintInvoice.vue",{default:function(t){n=t}},1),s.exportDefault({components:{PrintInvoice:n},data:function(){return{item:null,form:{invoiceNumber:null,date:a(new Date).format("YYYY-MM-DD"),customerId:null,items:[]},itemOpts:[],customerOpts:[],dialog:!1}},mounted:function(){this.getInvoiceNumber(),this.getCustomer(),this.getPurchase()},methods:{handleSubmit:function(){var t=this,e={invoiceNumber:this.form.invoiceNumber,customerId:this.form.customerId,date:a(this.form.date,"YYYY-MM-DD").toDate(),items:[]};this.form.items.forEach((function(t){e.items.push({_id:t._id,price:t.price,qty:t.qty})}));var s=this.customerOpts.findIndex((function(e){return e._id==t.form.customerId}));this.form.customer=this.customerOpts[s].name,Meteor.call("invoice.insert",e,(function(e,s){s&&(t.dialog=!0)}))},handleChangeItem:function(t){var e=this.form.items.findIndex((function(e){return e._id==t._id}));-1!=e?this.form.items[e].qty++:this.form.items.push({_id:t.itemId,name:t.name,price:t.price,qty:1})},handleRemove:function(t){this.$delete(this.form.items,t)},total:function(){var t=0;return this.form.items.forEach((function(e){t+=e.price*e.qty})),t},clearForm:function(){this.dialog=!1,this.form={invoiceNumber:null,date:a(new Date).format("YYYY-MM-DD"),customerId:null,items:[]},this.item=null,this.getInvoiceNumber()},getInvoiceNumber:function(){var t=this;Meteor.call("invoice.number",(function(e,s){s&&(t.form.invoiceNumber=s)}))},getPurchase:function(){var t=this;Meteor.call("purchase.find",(function(e,s){s&&(t.itemOpts=s)}))},getCustomer:function(){var t=this;Meteor.call("customer.find",(function(e,s){s&&(t.customerOpts=s)}))}}});var l="function"==typeof(i=i||{})?i.options||(i.options={}):i;l.render=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"q-pt-md q-mr-xl q-ml-xl"},[s("q-dialog",{attrs:{persistent:"",maximized:!0,"transition-show":"slide-up","transition-hide":"slide-down"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[s("q-card",[s("q-bar",[s("q-space"),t._v(" "),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],staticClass:"bg-red shadow-4",attrs:{dense:"",flat:"",icon:"close",color:"white",rounded:""}},[s("q-tooltip",{attrs:{"content-class":"bg-white text-primary "}},[t._v("Close")])],1)],1),t._v(" "),s("print-invoice",{attrs:{data:t.form},on:{close:t.clearForm}})],1)],1),t._v(" "),s("form",{on:{submit:function(e){return e.preventDefault(),t.handleSubmit(e)}}},[s("q-card",{staticClass:"shadow-6"},[s("q-card-section",{staticClass:"text-h5 text-center"},[t._v("Sale Form ")]),t._v(" "),s("q-card-section",[s("div",{staticClass:"row items-center"},[s("div",{staticClass:"col-md-8 col-xs-12"},[s("div",{staticClass:"col-xs-12 col-sm-4 q-ma-sm"},[s("q-input",{attrs:{square:"",outlined:"",type:"number",readonly:"",label:"Invoice Number"},model:{value:t.form.invoiceNumber,callback:function(e){t.$set(t.form,"invoiceNumber",t._n(e))},expression:"form.invoiceNumber"}})],1),t._v(" "),s("div",{staticClass:"col-xs-12 col-sm-4 q-ma-sm"},[s("q-input",{attrs:{square:"",outlined:"",readonly:"",type:"date",label:"Date"},model:{value:t.form.date,callback:function(e){t.$set(t.form,"date",e)},expression:"form.date"}})],1),t._v(" "),s("div",{staticClass:"col-xs-12 col-sm-4 q-ma-sm"},[s("q-select",{attrs:{square:"",outlined:"",options:t.customerOpts,label:"Customer","map-options":"","emit-value":"","option-label":"name","option-value":"_id",required:""},model:{value:t.form.customerId,callback:function(e){t.$set(t.form,"customerId",e)},expression:"form.customerId"}})],1),t._v(" "),s("div",{staticClass:"col-xs-12 col-sm-4 q-ma-sm"},[s("q-select",{attrs:{square:"",outlined:"",options:t.itemOpts,label:"Items","emit-value":"","map-options":"","option-label":"name"},on:{input:t.handleChangeItem},model:{value:t.item,callback:function(e){t.item=e},expression:"item"}})],1)]),t._v(" "),s("div",{staticClass:"col-md-4 col-xs-12"},[s("q-card",{staticClass:"q-pa-xl q-pr-xl",attrs:{flat:""}},[s("div",{staticClass:"text-h5 text-center"},[t._v("Total : "+t._s(t.total()))])])],1)]),t._v(" "),s("q-markup-table",[s("thead",[s("tr",[s("th",{staticClass:"text-left"},[t._v("No")]),t._v(" "),s("th",{staticClass:"text-left"},[t._v("Name")]),t._v(" "),s("th",{staticClass:"text-left"},[t._v("Price")]),t._v(" "),s("th",{staticClass:"text-left"},[t._v("Qty")]),t._v(" "),s("th",{staticClass:"text-left"},[t._v("Amount")]),t._v(" "),s("th",{staticClass:"text-left"},[t._v("Action")])])]),t._v(" "),s("tbody",t._l(t.form.items,(function(e,i){return s("tr",{key:i},[s("td",{staticClass:"text-left"},[t._v(t._s(i+1))]),t._v(" "),s("td",{staticClass:"text-left"},[t._v(t._s(e.name))]),t._v(" "),s("td",{staticClass:"text-left"},[t._v(t._s(e.price))]),t._v(" "),s("td",{staticClass:"text-left",staticStyle:{width:"150px"}},[s("q-input",{attrs:{type:"number"},model:{value:e.qty,callback:function(s){t.$set(e,"qty",t._n(s))},expression:"item.qty"}})],1),t._v(" "),s("td",{staticClass:"text-left"},[t._v(t._s(e.price*e.qty))]),t._v(" "),s("td",{staticClass:"text-left"},[s("q-btn",{attrs:{color:"red",icon:"delete",dense:"",flat:""},on:{click:function(e){return t.handleRemove(i)}}})],1)])})),0)]),t._v(" "),0!=t.form.items.length&&t.form.customerId?s("div",{staticClass:"text-center q-mt-lg"},[s("q-btn",{attrs:{color:"primary",label:"Submit",type:"submit"}})],1):t._e()],1)],1)],1)],1)},l.staticRenderFns=[],l._scopeId="data-v-1252a1ea",l.packageName="null",l.name=l.name||"sale",s.export("default",e.default=i),e.__esModule=!0}

